(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{108:function(e,t,n){"use strict";var a=n(1),o=n(5),r=n(9),c=n.n(r),s=n(0),l=n.n(s),i=n(10),u=l.a.forwardRef((function(e,t){var n=e.bsPrefix,r=e.noGutters,s=e.as,u=void 0===s?"div":s,f=e.className,d=Object(o.a)(e,["bsPrefix","noGutters","as","className"]),m=Object(i.a)(n,"row");return l.a.createElement(u,Object(a.a)({ref:t},d,{className:c()(f,m,r&&"no-gutters")}))}));u.defaultProps={noGutters:!1},t.a=u},286:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(94),c=n(108),s=n(75),l=n(44),i=n(43),u=n(47);class f extends o.a.Component{constructor(e){super(e),this.presence_ws=null,this.params=null,this.code=null,this.removeToken=()=>{console.log(),localStorage.removeItem("token"),this.props.history.push("/login")},this.state={loading:!0,error_type:"",oauth_logging_in:!1}}connect_presence(){return new Promise((e,t)=>{this.presence_ws=new WebSocket("wss://micromstag.westeurope.cloudapp.azure.com:8869"),this.presence_ws.onopen=()=>{console.log("ONOPEN"),this.presence_ws.send(JSON.stringify(localStorage.getItem("token"))),console.log("SENT")},this.presence_ws.onmessage=n=>{const a=JSON.parse(n.data);a.error?(console.log("closepressence"),this.presence_ws.close(),t(a.error_type)):(console.log("connect pressence"),e())}})}logInGoogle(){localStorage.getItem("token")?console.log("no token"):window.location.pathname.startsWith("/oauth/google")&&(this.code?(this.setState({loading:!1,oauth_logging_in:!0}),Object(u.e)("/oauth/google/",{code:this.params.get("code")}).then(e=>{console.log("Logged in via google"),localStorage.setItem("token",e.data.token),u.a.token=e.data.token,Object(u.c)("/users/profile/").then(e=>{console.log(e.data.username),e.data.username?window.location.href=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/":this.props.history.push("/set_nick")})})):console.log("no code"))}logInAccount(){return u.a.token=localStorage.getItem("token"),Object(u.c)("/users/profile/").then(e=>{e.data.username?this.connect_presence().then(()=>{console.log("lobby"),this.props.history.push("/lobby")}).catch(e=>{this.setState({error_type:e,loading:!1})}):this.props.history.push("/set_nick")}).catch(()=>{console.log("timeout"),localStorage.removeItem("token"),this.setState({loading:!1})})}componentDidMount(){this.params=new URLSearchParams(window.location.search),this.code=this.params.get("code"),this.code?this.logInGoogle():localStorage.getItem("token")?this.logInAccount():(this.setState({loading:!1}),console.log("no token"))}render(){return this.state.oauth_logging_in?o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement("h2",null,"Authorizing...")):this.state.loading?o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement("h2",null,"Loading...")):this.state.error_type?o.a.createElement("div",{className:"d-flex justify-content-center flex-column"},o.a.createElement("h2",null,this.state.error_type),o.a.createElement(r.a,{onClick:this.removeToken.bind(this),variant:"dark"},"Try again")):o.a.createElement(o.a.Fragment,null,o.a.createElement(c.a,null,o.a.createElement(s.a,{className:"d-flex justify-content-center"},o.a.createElement("h2",null,"Welcome to MSTAG!"))),o.a.createElement(c.a,null,o.a.createElement(s.a,{className:"d-flex justify-content-center"},o.a.createElement(l.a,{to:"/login"},o.a.createElement(r.a,{variant:"outline-dark",size:"lg"},"Log in!")))),o.a.createElement(c.a,null,o.a.createElement(s.a,{className:"d-flex justify-content-center"},o.a.createElement(l.a,{to:"/register"},o.a.createElement(r.a,{variant:"outline-dark",size:"lg"},"Sign up!")))),o.a.createElement(c.a,null,o.a.createElement(s.a,{className:"d-flex justify-content-center guest"},o.a.createElement(l.a,{to:"/login_guest"},o.a.createElement(r.a,{variant:"outline-dark",size:"lg"},"Play as guest!")))))}}t.default=Object(i.g)(f)},44:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(43),o=n(4),r=n(0),c=n.n(r),s=n(3),l=(n(6),n(1)),i=n(5),u=n(2);c.a.Component;c.a.Component;var f=function(e,t){return"function"==typeof e?e(t):e},d=function(e,t){return"string"==typeof e?Object(s.c)(e,null,null,t):e},m=function(e){return e},p=c.a.forwardRef;void 0===p&&(p=m);var h=p((function(e,t){var n=e.innerRef,a=e.navigate,o=e.onClick,r=Object(i.a)(e,["innerRef","navigate","onClick"]),s=r.target,u=Object(l.a)({},r,{onClick:function(e){try{o&&o(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),a())}});return u.ref=m!==p&&t||n,c.a.createElement("a",u)}));var g=p((function(e,t){var n=e.component,o=void 0===n?h:n,r=e.replace,s=e.to,g=e.innerRef,v=Object(i.a)(e,["component","replace","to","innerRef"]);return c.a.createElement(a.e.Consumer,null,(function(e){e||Object(u.a)(!1);var n=e.history,a=d(f(s,e.location),e.location),i=a?n.createHref(a):"",h=Object(l.a)({},v,{href:i,navigate:function(){var t=f(s,e.location);(r?n.replace:n.push)(t)}});return m!==p?h.ref=t||g:h.innerRef=g,c.a.createElement(o,h)}))})),v=function(e){return e},b=c.a.forwardRef;void 0===b&&(b=v);b((function(e,t){var n=e["aria-current"],o=void 0===n?"page":n,r=e.activeClassName,s=void 0===r?"active":r,m=e.activeStyle,p=e.className,h=e.exact,y=e.isActive,k=e.location,w=e.strict,E=e.style,j=e.to,O=e.innerRef,N=Object(i.a)(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","strict","style","to","innerRef"]);return c.a.createElement(a.e.Consumer,null,(function(e){e||Object(u.a)(!1);var n=k||e.location,r=d(f(j,n),n),i=r.pathname,_=i&&i.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),x=_?Object(a.f)(n.pathname,{path:_,exact:h,strict:w}):null,S=!!(y?y(x,n):x),R=S?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(p,s):p,A=S?Object(l.a)({},E,{},m):E,C=Object(l.a)({"aria-current":S&&o||null,className:R,style:A,to:r},N);return v!==b?C.ref=t||O:C.innerRef=O,c.a.createElement(g,C)}))}))},47:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d}));var a=n(56),o=n.n(a),r=n(57),c=n.n(r);const s="https://micromstag.westeurope.cloudapp.azure.com:443/api/v1";function l(e){return f.token?o.a.get(s+e,{headers:{Authorization:"Token "+f.token}}):o.a.get(s+e)}function i(e,t){return f.token?o.a.post(s+e,t,{headers:{Authorization:"Token "+f.token}}):o.a.post(s+e,t)}function u(e){return c()(s+e,{method:"GET",headers:{Authorization:"Token "+f.token}},{metadata:!0})}const f={username:"",player_id:-1,token:""},d={address:""}},75:function(e,t,n){"use strict";var a=n(1),o=n(5),r=n(9),c=n.n(r),s=n(0),l=n.n(s),i=n(10),u=["xl","lg","md","sm","xs"],f=l.a.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,s=e.as,f=void 0===s?"div":s,d=Object(o.a)(e,["bsPrefix","className","as"]),m=Object(i.a)(n,"col"),p=[],h=[];return u.forEach((function(e){var t,n,a,o=d[e];if(delete d[e],null!=o&&"object"==typeof o){var r=o.span;t=void 0===r||r,n=o.offset,a=o.order}else t=o;var c="xs"!==e?"-"+e:"";null!=t&&p.push(!0===t?""+m+c:""+m+c+"-"+t),null!=a&&h.push("order"+c+"-"+a),null!=n&&h.push("offset"+c+"-"+n)})),p.length||p.push(m),l.a.createElement(f,Object(a.a)({},d,{ref:t,className:c.a.apply(void 0,[r].concat(p,h))}))}));f.displayName="Col",t.a=f},94:function(e,t,n){"use strict";var a=n(1),o=n(5),r=n(9),c=n.n(r),s=n(0),l=n.n(s),i=n(10);var u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return null!=e})).reduce((function(e,t){if("function"!=typeof t)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];e.apply(this,a),t.apply(this,a)}}),null)};function f(e){return!e||"#"===e.trim()}var d=l.a.forwardRef((function(e,t){var n=e.as,r=void 0===n?"a":n,c=e.disabled,s=e.onKeyDown,i=Object(o.a)(e,["as","disabled","onKeyDown"]),d=function(e){var t=i.href,n=i.onClick;(c||f(t))&&e.preventDefault(),c?e.stopPropagation():n&&n(e)};return f(i.href)&&(i.role=i.role||"button",i.href=i.href||"#"),c&&(i.tabIndex=-1,i["aria-disabled"]=!0),l.a.createElement(r,Object(a.a)({ref:t},i,{onClick:d,onKeyDown:u((function(e){" "===e.key&&(e.preventDefault(),d(e))}),s)}))}));d.displayName="SafeAnchor";var m=d,p=l.a.forwardRef((function(e,t){var n=e.bsPrefix,r=e.variant,s=e.size,u=e.active,f=e.className,d=e.block,p=e.type,h=e.as,g=Object(o.a)(e,["bsPrefix","variant","size","active","className","block","type","as"]),v=Object(i.a)(n,"btn"),b=c()(f,v,u&&"active",v+"-"+r,d&&v+"-block",s&&v+"-"+s);if(g.href)return l.a.createElement(m,Object(a.a)({},g,{as:h,ref:t,className:c()(b,g.disabled&&"disabled")}));t&&(g.ref=t),h||(g.type=p);var y=h||"button";return l.a.createElement(y,Object(a.a)({},g,{className:b}))}));p.displayName="Button",p.defaultProps={variant:"primary",active:!1,disabled:!1,type:"button"};t.a=p}}]);